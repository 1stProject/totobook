<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="totoBook.store.mapper.ProductMapper">


	<sql id="selectpd">
		select PRODUCT_ID, PRODUCT_NAME, PRICE, category, DETAIL,
		IMAGE_ADDRESS, IMAGE_EXT
		from product_TB
	</sql>

	<insert id="registerProduct" parameterType="Product">
		INSERT INTO
		PRODUCT_TB(PRODUCT_ID, PRODUCT_NAME, PRICE, category, DETAIL,
		IMAGE_ADDRESS, IMAGE_EXT)
		VALUES(PRODUCT_SEQ.NEXTVAL, #{PRODUCT_NAME},
		#{PRICE}, #{category}, #{DETAIL}, #{IMAGE_ADDRESS},
		#{IMAGE_EXT})
	</insert>

	<insert id="registerOption" parameterType="Option">
		INSERT INTO
		option_tb(option_id, option_name, value, option_price,
		product_id)
		values (option_seq.nextval, #{option_name}, #{option_name}, #{value},
		#{option_price}, #{product_id})
	</insert>

	<update id="modifyProduct" parameterType="Product">
		UPDATE product_tb
		SET
		PRODUCT_NAME = #{PRODUCT_NAME}, PRICE = #{PRICE},
		category =
		#{category}, DETAIL=#{DETAIL},
		IMAGE_ADDRESS = #{IMAGE_ADDRESS},
		IMAGE_EXT= #{IMAGE_EXT}
		where product_id = #{product_id}
	</update>

	<update id="modifyOption" parameterType="Option">
		update Option_tb
		set
		option_name = #{option_name}, value = #{value},
		option_price=#{option_price}
		where product_id = #{product_id}
	</update>

	<delete id="deleteProduct">
		DELETE product_tb
		WHERE product_id = #{product.product_id}
	
	
	</delete>

	<delete id="removeOption">
		DELETE option_tb
		WHERE option_id = #{option_id}
	</delete>

	<select id="findAllProducts" parameterType="Product">
		<include refid="selectpd" />
	</select>


	<select id="findProductsByCategory" parameterType="String">
		<include refid="selectpd" />
		where category = #{category}
	</select>

	<select id="findProductsByName" parameterType="String">
		<include refid="selectpd" />
		where product_name like #{product_name}
		
	</select>

	<select id="findProductById" parameterType="product">
		<include refid="selectpd" />
		where PRODUCT_ID = #{PRODUCT_ID}
	</select>

	<select id="findOption" parameterType="String">

		SELECT FROM 
		option_tb(option_id, option_name, value, option_price,
		product_id)
		where product_id = #{product_id%} 	
	
	</select>


</mapper>